var E=Object.defineProperty;var C=(n,e,t)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var i=(n,e,t)=>(C(n,typeof e!="symbol"?e+"":e,t),t);const F=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}};F();class h{constructor(e,t,a,r){i(this,"text");i(this,"cssList");i(this,"callback");i(this,"isDisabled");i(this,"element");this.text=e,this.cssList=t||[],this.callback=a,this.isDisabled=r||!1,this.element=this.initElement()}initElement(){let e=document.createElement("button");return e.innerHTML=this.text,this.cssList.forEach(t=>{e.classList.add(t)}),this.isDisabled&&e.setAttribute("disabled","disabled"),e.addEventListener("click",this.callback),e}toggleDisable(){this.isDisabled=!this.isDisabled,this.isDisabled?this.element.setAttribute("disabled","disabled"):this.element.removeAttribute("disabled")}}class b{constructor(e,t,a,r,s){i(this,"id");i(this,"type");i(this,"cssList");i(this,"isDisabled");i(this,"placeholder");i(this,"element");this.id=t,this.type=a||"text",this.cssList=e||[],this.placeholder=r||"",this.isDisabled=s||!1,this.element=this.initElement()}initElement(){let e=document.createElement("input");return e.setAttribute("type",this.type),e.setAttribute("placeholder",this.placeholder),e.id=this.id,e.classList.add("form-control"),this.cssList.forEach(t=>{e.classList.add(t)}),this.isDisabled&&e.setAttribute("disabled","disabled"),e}toggleDisable(){this.isDisabled=!this.isDisabled,this.isDisabled?this.element.setAttribute("disabled","disabled"):this.element.removeAttribute("disabled")}}class l{constructor(e=[],t=[]){i(this,"elements");i(this,"cssList");i(this,"element");this.cssList=e||[],this.elements=t||[],this.element=this.initElement()}initElement(){let e=document.createElement("div");return e.classList.add("col"),this.cssList.forEach(t=>{e.classList.add(t)}),this.elements.forEach(t=>{e.append(t.element)}),e}}class c{constructor(e=[],t=[]){i(this,"columns");i(this,"cssList");i(this,"element");this.cssList=e||[],this.columns=t||[],this.element=this.initElement()}initElement(){let e=document.createElement("div");return e.classList.add("row"),this.cssList.forEach(t=>{e.classList.add(t)}),this.columns.forEach(t=>{e.append(t.element)}),e}addColumn(e){this.columns.push(e)}}class S{constructor(){i(this,"element");this.element=document.createElement("div"),this.element.id="select-area",document.getElementById("game").append(this.element)}displayDebug(){let e=new h("Add",["btn","btn-primary","w-100"],()=>{}),t=new h("Delete",["btn","btn-danger","w-100"],()=>{}),a=new b(["w-100"],"testInput"),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r,s]),u=new c([],[o]);this.setView([d,u])}setView(e){this.element.innerHTML="",e.forEach(t=>{this.element.append(t.element)})}clearView(){this.element.innerHTML=""}setInactive(){this.element.classList.add("inactive-bottom")}setActive(){this.element.classList.remove("inactive-bottom")}}class V{constructor(){i(this,"containerElement");i(this,"imageArea");i(this,"displayArea");this.imageArea=document.createElement("div"),this.imageArea.id="picture-area",this.displayArea=document.createElement("div"),this.displayArea.id="display-area",this.containerElement=document.getElementById("displays"),this.containerElement.append(this.imageArea),this.containerElement.append(this.displayArea)}async displayText(e){this.displayArea.innerHTML="";let t=[];t=e.split("");let a=0;for(;t.length>a;)await this.waitForMS(10),this.displayArea.innerHTML+=t[a],a++}async waitForMS(e){return new Promise(t=>setTimeout(t,e))}}let I={colors:["#054db2","#f2b124","#8c0505"]};class R{constructor(){i(this,"element",null);i(this,"player_faction",null);i(this,"citizens",{amount:null,maximum:null});i(this,"food",{amount:null,maximum:null});i(this,"land",{amount:null,maximum:null});i(this,"credits",null);i(this,"year",null);this.element=document.getElementById("status-bar"),this.setInactive()}setFaction(e){this.player_faction=e,this.draw()}setCitizens(e){this.citizens=e,this.draw()}setFood(e){this.food=e,this.draw()}setLand(e){this.land=e,this.draw()}setCredits(e){this.credits=e,this.draw()}setYear(e){this.year=e,this.draw()}update(e){this.credits=e.credits||this.credits,this.food=e.food||this.food,this.land=e.land||this.land,this.citizens=e.citizen||this.citizens,this.year=e.year||this.year,this.draw()}draw(){this.setActive(),this.element.innerHTML="";let e=new l;e.element.style.background=I.colors[this.player_faction];let t=new l;t.element.innerHTML=`<div><img src="./src/img/icons/ed_icon_B.png" class="icon me-4" alt="picture">\u20AC/$ ${this.credits}</div>`;let a=new l;a.element.innerHTML=`<div><img src="./src/img/icons/food_icon.png" class="icon me-4" alt="picture">FOOD ${this.food.amount}/${this.food.maximum}</div>`;let r=new l;r.element.innerHTML=`<div><img src="./src/img/icons/land_icon.png" class="icon me-4" alt="picture">LAND ${this.land.amount}/${this.land.maximum}</div>`;let s=new l;s.element.innerHTML=`<div><img src="./src/img/icons/citizens_icon.png" class="icon me-4" alt="picture">CITIZEN ${this.citizens.amount}/${this.citizens.maximum}</div>`;let o=new l;o.element.innerHTML=`<div><div><img src="./src/img/icons/year_icon.png" class="icon me-4" alt="picture">YEAR ${this.year}</div>`;let d=new c(["g-0"],[e,t,a,r,s,o]);this.element.append(d.element)}setInactive(){this.element.classList.add("inactive-top")}setActive(){this.element.classList.remove("inactive-top")}}var v;(function(n){n[n.faction_1=0]="faction_1",n[n.faction_2=1]="faction_2",n[n.faction_3=2]="faction_3"})(v||(v={}));var L;(function(n){n[n.expandable=0]="expandable",n[n.buildable=1]="buildable"})(L||(L={}));var w;(function(n){n[n.very_unhappy=0]="very_unhappy",n[n.unhappy=1]="unhappy",n[n.normal=2]="normal",n[n.happy=3]="happy",n[n.very_Happy=4]="very_Happy"})(w||(w={}));var x;(function(n){n[n.very_hungry=0]="very_hungry",n[n.hungry=1]="hungry",n[n.normal=2]="normal",n[n.saturated=3]="saturated",n[n.very_saturated=4]="very_saturated"})(x||(x={}));var M;(function(n){n[n.female=0]="female",n[n.male=1]="male"})(M||(M={}));var z;(function(n){n[n.kid=0]="kid",n[n.adult=1]="adult",n[n.grandpa=2]="grandpa"})(z||(z={}));var p;(function(n){n[n.no_land=0]="no_land",n[n.no_credits=1]="no_credits",n[n.negative=2]="negative",n[n.no_trade=3]="no_trade"})(p||(p={}));var m;(function(n){n[n.no_food=0]="no_food",n[n.no_land=1]="no_land",n[n.no_citizen=2]="no_citizen",n[n.negative=3]="negative"})(m||(m={}));var y;(function(n){n[n.no_food=0]="no_food",n[n.negative=1]="negative"})(y||(y={}));let T={choose_faction:{text:"Choose your Faction you want to play!"},main_menu:{text:" we are waiting for you orders."}},_={factions:{faction_1:"European Union",faction_2:"American Trade Company",faction_3:"Red Legion"},greeting:["greetings sir","Hello president","greetings comrade"]},k={faction_1:{name:_.factions.faction_1,description:`The European Union
 
 an alliance of European countries that promotes democracy, freedom and equality. A commendable ideology, but the path is difficult if different cultures and opinions are to find a consensus.
 
Those who do not live here know Europe as the land of freedom, the inhabitants call it the bureaucratic hell.`,history:"",characteristics:""},faction_2:{name:_.factions.faction_2,description:`The American Company (TAC)
 
 is known for its capitalist governance.
 Money is worth more than ethical values. 
 
 Money equals power and the powerful set the rules.`,history:"",characteristics:""},faction_3:{name:_.factions.faction_3,description:`The Red Legion
 
a religious state that has adopted the idiology of communism. 
 
All are equal under the leadership of the state which goes hand in hand with the Catholic Church.
        `,history:"",characteristics:""}},f={food_manager:{seeds_on_land:{no_food:"you do not have enough food.",no_land:"you do not have enough free land.",no_citizen:"you do not have enough citizens.",negative:"you cant go in to a negative value"},distribut_food:{no_food:"you do not have enough food",negative:"you cant go in to a negative value"}},land_manager:{buy_land:{no_credits:"you dont heave enough credits",no_land:"you cant buy more Land than the limit of the Bank allows.",negative:"You cant sell more land than you own.",no_trade:"You can trade Land only once a year"}}};class ${constructor(){i(this,"profit_range",50);i(this,"base_profit_min",25);i(this,"food_profit_rate");i(this,"cultivated_land",0);i(this,"cultivated_land_profit",0);i(this,"needed_citizens_for_land",1);i(this,"need_seeds_for_land",3);i(this,"cultivated_greenhouse",0);i(this,"cultivated_greenhouse_profit",0);i(this,"needed_citizens_for_greenhouse",3);i(this,"need_seeds_for_greenhouse",1);i(this,"food_profit_this_year",0);i(this,"distributed_food",0)}newYearRoutine(e){}setCultivatedLand(e,t,a,r){let s=r.length,o;if(e!==void 0||e!==null)if(this.cultivated_land+e>0)if(t>=e){let d=e*this.need_seeds_for_land;if(a*this.need_seeds_for_land>=d){if(s*this.needed_citizens_for_land>=e*this.needed_citizens_for_land)return a-=e,this.cultivated_land+=e,{amount:e,cost:d,error:!1};o=m.no_citizen}else o=m.no_food}else o=m.no_land;else o=m.negative;return{amount:0,cost:0,error:!0,error_message:this.seedsOnLandErrorHandler(o)}}seedsOnLandErrorHandler(e){switch(e){case m.no_food:return f.food_manager.seeds_on_land.no_food;case m.no_citizen:return f.food_manager.seeds_on_land.no_citizen;case m.no_land:return f.food_manager.seeds_on_land.no_land;case m.negative:return f.food_manager.seeds_on_land.negative;default:return console.error("Fehlerhafte Message Range"),""}}diceLandProfitRate(){this.food_profit_rate=0,this.food_profit_rate=Math.floor(Math.random()*this.profit_range+this.base_profit_min)}calLandProfit(){this.cultivated_land_profit=0,this.cultivated_land_profit=this.cultivated_land*this.food_profit_rate}harvestProfit(){this.diceLandProfitRate(),this.calLandProfit();let e=this.cultivated_land_profit+this.cultivated_greenhouse_profit;return this.food_profit_this_year=e,console.table({food_profit_rate:this.food_profit_rate,planted_land_profit:this.cultivated_land_profit,planted_greenhouse_profit:this.cultivated_greenhouse_profit,profit:e}),this.cultivated_land=0,this.cultivated_greenhouse=0,e}setDistributFood(e,t){let a;if(e!==void 0||e!==null)if(e+this.distributed_food>0){if(t>e)return this.distributed_food+=e,{amount:e,cost:t,error:!1};a=y.no_food}else a=y.negative;return{amount:0,cost:0,error:!0,error_message:this.distributFoodErrorHandler(a)}}distributFoodErrorHandler(e){switch(e){case y.no_food:return f.food_manager.distribut_food.no_food;case y.negative:return f.food_manager.distribut_food.negative;default:return console.error("Fehlerhafte Message Range"),""}}resetDistributedFood(){this.distributed_food=0}getCultivatedLand(){return this.cultivated_land}}class Y{constructor(){i(this,"price_per_land",25);i(this,"landtrade_done",!1);i(this,"price_range",40);i(this,"min_price",10);this.randomLandprice()}newYearRoutine(){this.randomLandprice(),this.landtrade_done=!1}buyLand(e,t,a,r){let s=e*this.price_per_land,o;if(this.landtrade_done==!1){if(e!==void 0||e!==null)if(e+a>0)if(e+a<r){if(t>s)return this.landtrade_done=!0,{amount:e,cost:s,error:!1};o=p.no_credits}else o=p.no_land;else o=p.negative}else o=p.no_trade;return{amount:0,cost:0,error:!0,error_message:this.buyLandErrorHandler(o)}}buyLandErrorHandler(e){switch(e){case p.no_land:return f.land_manager.buy_land.no_land;case p.no_credits:return f.land_manager.buy_land.no_credits;case p.negative:return f.land_manager.buy_land.negative;case p.no_trade:return f.land_manager.buy_land.no_trade;default:return console.error("Fehlerhafte Message Range"),""}}randomLandprice(){this.price_per_land=0,this.price_per_land=Math.floor(Math.random()*this.price_range+this.min_price)}getLandPrice(){return this.price_per_land}}class B{constructor(){i(this,"gender",Math.floor(Math.random()*2));i(this,"age",0);i(this,"mature_time",12);i(this,"grandpa_time",60);i(this,"life_stage",0);i(this,"depression",0);i(this,"happiness",0);i(this,"happiness_state",0);i(this,"isHorny",!1);i(this,"hunger",15);i(this,"saturation",2);i(this,"mortality_rate",.05)}checkDeath(){let e=this.mortality_rate*this.age+this.depression/5;return Math.floor(Math.random()*150)<e}grow(){switch(this.age++,this.age){case this.mature_time:this.life_stage=z.adult,this.setHunger(5),this.mortality_rate=.4,this.setDepression(5);break;case this.grandpa_time:this.life_stage=z.grandpa,this.setHunger(-2),this.mortality_rate=.8;break}}setDepression(e){(0<e||e<100)&&(this.depression+=e,this.depression>100?this.depression=100:this.depression<0&&(this.depression=0))}setHunger(e){(5<e||e<25)&&(this.hunger+=e,this.hunger>25?this.hunger=25:this.hunger<5&&(this.hunger=5))}setSaturation(e){(0<e||e<4)&&(this.saturation+=e,this.saturation>=4?this.saturation=4:this.saturation<0&&(this.saturation=0))}setHappiness(e){(0<e||e<100)&&(this.happiness+=e,this.happiness>100?this.happiness=100:this.happiness<0&&(this.happiness=0),this.setHappinessState())}setHappinessState(){this.happiness>0&&this.happiness<15?this.happiness_state=w.very_unhappy:this.happiness>15&&this.happiness<39?this.happiness_state=w.unhappy:this.happiness>40&&this.happiness<59?this.happiness_state=w.normal:this.happiness>60&&this.happiness<79?this.happiness_state=w.happy:this.happiness>80&&(this.happiness_state=w.very_Happy)}checkHorny(){this.life_stage>0&&this.happiness_state>0&&this.saturation>1&&this.depression<80&&(this.isHorny=!0)}getDepression(){return this.depression}getAge(){return this.age}getHunger(){return this.hunger}getHappiness(){return this.happiness}getHorny(){return this.isHorny}getGender(){return this.gender}}class O{constructor(){i(this,"population",0);i(this,"citizen_hunger_sum",0);i(this,"citizen_hunger_ave",0);i(this,"citizen_depression_sum",0);i(this,"citizen_depression_ave",0);i(this,"citizen_happiness_sum",0);i(this,"citizen_happiness_ave",0);i(this,"citizen_age_sum",0);i(this,"citizen_age_ave",0);i(this,"citizen_dead_this_year",0);i(this,"citizen_new_this_year",0);i(this,"citizen_dead",0)}newYearRoutine(e,t){this.citizen_new_this_year=0,this.citizen_dead_this_year=0,this.refreshStats(e),this.calHornyState(e),this.yearHunger(e),this.feedCitizen(e,t),this.checkDeath(e),this.makeAllOld(e,1),this.refreshStats(e),this.makeAllHappy(e,Math.floor(Math.random()*100))}createCitizen(e,t){for(let a=0;a<e;a++)t.push(new B),this.population++}checkDeath(e){e.forEach((t,a)=>{t.checkDeath()&&(e.splice(a,1),this.population--,this.citizen_dead++,this.citizen_dead_this_year++)})}feedCitizen(e,t){let a=[];e.forEach(s=>{a.push(s.hunger)});let r=Math.min(...a);if(t>0){let s=0;for(e.sort((o,d)=>o.saturation-d.saturation);t>=r;)if(t>r)t-=e[s].getHunger(),e[s].setSaturation(1),s++,s>=e.length&&(s=0);else return;t<0&&(console.error("citzen feed system: distributed food is negative"),console.log(`Distributed food : ${t}`))}}yearHunger(e){e.forEach(t=>{t.setSaturation(-1)})}bornNewCitizen(e){let t=0,a=0,r=0,s=0;for(e.forEach(o=>{o.getHorny()&&(o.gender===M.female?t++:o.gender===M.male?a++:console.error("Citizen Gender not found"))});a>0&&t>0;)r++,t--,a--;for(let o=r;o>0;o--){let d=Math.floor(Math.random()*100);d>0&&d<40||(d>40&&d<=80?s++:d>80&&d<=95?s+=2:d>95&&d<=100&&(s+=3))}this.citizen_new_this_year+=s,this.createCitizen(s,e)}refreshStats(e){this.calAveAge(e),this.calSumHunger(e),this.calAveDepression(e),this.calAveHappiness(e)}makeAllOld(e,t){e.forEach(a=>{let r=t;for(let s=0;s<r;s++)a.grow()})}makeAllOldRandom(e,t,a){e.forEach(r=>{let s=Math.floor(Math.random()*a+t);for(let o=0;o<s;o++)r.grow()})}makeAllHappy(e,t){e.forEach(a=>{let r=t;a.setHappiness(r)})}calSumDepression(e){this.citizen_depression_sum=0,e.forEach(t=>{this.citizen_depression_sum+=t.getDepression()})}calAveDepression(e){this.citizen_depression_ave=0,this.calSumDepression(e),this.citizen_depression_ave=Math.floor(this.citizen_depression_sum/this.population)}calSumHappiness(e){this.citizen_happiness_sum=0,e.forEach(t=>{this.citizen_happiness_sum+=t.getHappiness()})}calAveHappiness(e){this.citizen_happiness_ave=0,this.calSumHappiness(e),this.citizen_happiness_ave=Math.floor(this.citizen_happiness_sum/this.population)}calSumAge(e){this.citizen_age_sum=0,e.forEach(t=>{this.citizen_age_sum+=t.getAge()})}calAveAge(e){this.citizen_age_ave=0,this.calSumAge(e),this.citizen_age_ave=Math.floor(this.citizen_age_sum/this.population)}calSumHunger(e){this.citizen_hunger_sum=0,e.forEach(t=>{this.citizen_hunger_sum+=t.getHunger()})}calAveHunger(e){this.citizen_hunger_ave=0,this.calSumHunger(e),this.citizen_hunger_ave+=Math.floor(this.citizen_hunger_sum/this.population)}calHornyState(e){e.forEach(t=>{t.checkHorny()})}getCitizenPopulation(){return this.population}getCitizenDeadThisYear(){return this.citizen_dead_this_year}getCitizenHungerSum(e){return this.calSumHunger(e),this.citizen_hunger_sum}getCitizenDepressionAve(e){return this.calAveDepression(e),this.citizen_depression_ave}getCitizensHappinessAve(e){return this.calAveHappiness(e),this.citizen_happiness_ave}}class G{constructor(){i(this,"buildings_maintenance");i(this,"buildings_land_occupied",50);i(this,"appartments",0);i(this,"food_storage",0);i(this,"buildings")}getLandOccupied(){return this.buildings_land_occupied}getAppartments(){return this.appartments}getFoodStorage(){return this.food_storage}}class N{constructor(){i(this,"name");i(this,"level");i(this,"type");i(this,"maintenance");i(this,"build_cost_credits");i(this,"build_cost_land")}}class P extends N{constructor(){super();this.maintenance=100}}class q{constructor(){i(this,"building_tax_sum");i(this,"credits_income");i(this,"citizen_tax",.1);i(this,"credits_expenses");i(this,"credits_balance")}calIncome(e){this.credits_income=0,this.credits_income=this.citizen_tax*e}calExpenses(){this.credits_expenses=0}calBalance(e){this.calIncome(e),this.calExpenses(),this.credits_balance=0,this.credits_balance=this.credits_income-this.credits_expenses}calcGreenhouse(e){e.maintenance*1}calBuildingTaxSum(){}}class U{constructor(e){i(this,"versionNumber");i(this,"element");this.versionNumber=e||"",this.element=this.createHTMLElement(),this.appendToView()}createHTMLElement(){let e=document.createElement("div"),t=document.createElement("div");return t.innerText=`v${this.versionNumber}`,t.id="version-number",e.id="version-display",e.append(t),e}appendToView(){document.querySelector("body").append(this.element)}}class K{constructor(){i(this,"handler",{selectAreaHandler:null,displayHandler:null});i(this,"player_faction");i(this,"year",0);i(this,"credits",0);i(this,"land_bank",2500);i(this,"land_avaible");i(this,"land_free",0);i(this,"land_occupied",0);i(this,"land_amount");i(this,"food_amount",0);i(this,"food_storage",0);i(this,"citizen",[]);i(this,"appartments",0);i(this,"infobar");i(this,"foodManager");i(this,"landManager");i(this,"citizenManager");i(this,"FinanceManager");i(this,"BuildingManager");i(this,"greenhouse");i(this,"versionDisplay");this.handler.displayHandler=new V,this.handler.selectAreaHandler=new S,this.infobar=new R,this.foodManager=new $,this.landManager=new Y,this.citizenManager=new O,this.FinanceManager=new q,this.BuildingManager=new G,this.greenhouse=new P,this.FinanceManager.calcGreenhouse(this.greenhouse),this.versionDisplay=new U("0.1.3"),this.displayChooseFaction()}newYear(){if(console.log(this.citizen),this.citizenManager.newYearRoutine(this.citizen,this.foodManager.distributed_food),this.citizenManager.bornNewCitizen(this.citizen),this.landManager.newYearRoutine(),this.food_amount+=this.foodManager.harvestProfit(),this.land_free+=this.foodManager.getCultivatedLand(),this.checkGameOver()){this.showGameOver();return}else this.showReport(),this.year++,this.updateInfoBarAll()}async initGame(e){switch(this.year=1,this.infobar.setFaction(this.player_faction),e){case 0:this.credits=4500,this.food_amount=5e3,this.land_free=450,this.citizenManager.createCitizen(75,this.citizen),this.citizenManager.makeAllOldRandom(this.citizen,18,30),this.citizenManager.makeAllHappy(this.citizen,Math.floor(Math.random()*80+20));break;case 1:this.credits=9500,this.food_amount=5e3,this.land_free=450,this.citizenManager.createCitizen(50,this.citizen),this.citizenManager.makeAllOldRandom(this.citizen,18,65),this.citizenManager.makeAllHappy(this.citizen,Math.floor(Math.random()*80+20));break;case 2:this.credits=1500,this.food_amount=1e4,this.land_free=450,this.citizenManager.createCitizen(100,this.citizen),this.citizenManager.makeAllOldRandom(this.citizen,18,40),this.citizenManager.makeAllHappy(this.citizen,Math.floor(Math.random()*80+20));break}this.citizenManager.checkDeath(this.citizen),this.citizenManager.refreshStats(this.citizen),this.infobar.draw(),this.infobar.setActive(),this.mainMenu(),this.updateInfoBarAll(),console.log(this.citizen)}resetGameData(){this.year=0,this.credits=0,this.food_amount=0,this.land_free=0,this.citizen=[]}checkGameOver(){return this.citizen.length<1||this.credits<-500}updateInfoBarAll(){this.getFoodStorage(),this.getAppartments(),this.calLand_avaible(),this.infobar.update({credits:this.credits,food:{amount:this.food_amount,maximum:this.food_storage},land:{amount:this.land_free,maximum:this.land_amount},citizen:{amount:this.citizenManager.population,maximum:this.appartments},year:this.year})}calLandAmount(){this.getOccupiedLand(),this.land_amount=0,this.land_amount=this.land_free+this.land_occupied}calLand_avaible(){this.calLandAmount(),this.land_avaible=0,this.land_avaible=this.land_bank-this.land_amount}getFoodStorage(){this.food_storage=this.BuildingManager.getFoodStorage()}getAppartments(){this.appartments=this.BuildingManager.getAppartments()}getOccupiedLand(){this.land_occupied=this.BuildingManager.getLandOccupied()}async displayChooseFaction(){this.resetGameData(),this.clearView(),await this.handler.displayHandler.displayText(T.choose_faction.text);let e=new h(_.factions.faction_1,["btn","btn-primary","w-100"],()=>this.confirmFaction(_.factions.faction_1)),t=new h(_.factions.faction_2,["btn","btn-primary","w-100"],()=>this.confirmFaction(_.factions.faction_2)),a=new h(_.factions.faction_3,["btn","btn-primary","w-100"],()=>this.confirmFaction(_.factions.faction_3)),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r,s,o]);this.setView([d])}async confirmFaction(e){switch(this.clearView(),e){case _.factions.faction_1:await this.handler.displayHandler.displayText(k.faction_1.description),this.player_faction=v.faction_1;break;case _.factions.faction_2:await this.handler.displayHandler.displayText(k.faction_2.description),this.player_faction=v.faction_2;break;case _.factions.faction_3:await this.handler.displayHandler.displayText(k.faction_3.description),this.player_faction=v.faction_3;break}let t=new h("start",["btn","btn-primary","w-100"],()=>this.initGame(this.player_faction)),a=new h("back",["btn","btn-primary","w-100"],()=>this.displayChooseFaction()),r=new l([],[t]),s=new l([],[a]),o=new c([],[r]),d=new c([],[s]);this.setView([o,d])}async mainMenu(){this.citizenManager.calSumHunger(this.citizen),await this.handler.displayHandler.displayText(`${_.greeting[this.player_faction]}${T.main_menu.text}`);let e=new h("trade",["btn","btn-primary","w-100"],()=>this.tradeMenu()),t=new h("Manage food",["btn","btn-primary","w-100"],()=>this.manageFoodMenu()),a=new h("build",["btn","btn-primary","w-100"],()=>{},!0),r=new h("technology",["btn","btn-primary","w-100"],()=>{},!0),s=new h("next Year",["btn","btn-primary","w-100"],()=>this.newYear()),o=new l([],[e]),d=new l([],[t]),u=new l([],[a]),g=new l([],[r]),H=new l([],[s]),A=new c([],[o,d,u,g]),D=new c([],[H]);this.handler.selectAreaHandler.setView([A,D])}async tradeMenu(){this.handler.selectAreaHandler.clearView(),await this.handler.displayHandler.displayText("Trade Menu");let e=new h("trade land",["btn","btn-primary","w-100"],()=>this.landTradeMenu()),t=new h("trade food",["btn","btn-primary","w-100"],()=>this.foodTradeMenu()),a=new h("back",["btn","btn-primary","w-100"],()=>this.mainMenu()),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r,s]),u=new c([],[o]);this.handler.selectAreaHandler.setView([d,u])}async landTradeMenu(){this.calLand_avaible(),await this.handler.displayHandler.displayText("The Price for 1 claim of Land cost "+this.landManager.price_per_land+` credits. 
 For now the bank have ${this.land_avaible} claims to sell. 
 Dont forget that you can only trade land once a year.`);let e=new b(["w-100"],"land-trade-amount"),t=new h("buy land",["btn","btn-primary","w-100"],async()=>this.buyLand(e.element)),a=new h("back",["btn","btn-primary","w-100"],()=>this.tradeMenu()),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r]),u=new c([],[s]),g=new c([],[o]);this.handler.selectAreaHandler.setView([d,u,g])}async buyLand(e){let t=this.landManager.buyLand(parseInt(e.value),this.credits,this.land_free,this.land_avaible);t.error?await this.handler.displayHandler.displayText(`I'm sorry commander, but ${t.error_message}`):(this.land_free+=t.amount,this.land_bank-=t.amount,this.credits-=t.cost,this.calLandAmount(),this.infobar.update({credits:this.credits,land:{amount:this.land_free,maximum:this.land_amount}}),this.landTradeMenu())}async foodTradeMenu(){let e=new b(["w-100"],"food-trade-amount"),t=new h("buy land",["btn","btn-primary","w-100"],()=>{}),a=new h("sell land",["btn","btn-primary","w-100"],()=>{}),r=new h("back",["btn","btn-primary","w-100"],()=>this.tradeMenu()),s=new l([],[e]),o=new l([],[t]),d=new l([],[a]),u=new l([],[r]),g=new c([],[s]),H=new c([],[o,d]),A=new c([],[u]);this.handler.selectAreaHandler.setView([g,H,A])}async manageFoodMenu(){this.handler.selectAreaHandler.clearView(),await this.handler.displayHandler.displayText("Manage food Menu");let e=new h("plant Seeds",["btn","btn-primary","w-100"],()=>this.plantSeedsMenu()),t=new h("distribute food",["btn","btn-primary","w-100"],()=>this.distributeFoodMenu()),a=new h("back",["btn","btn-primary","w-100"],()=>this.mainMenu()),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r,s]),u=new c([],[o]);this.handler.selectAreaHandler.setView([d,u])}async plantSeedsMenu(){await this.handler.displayHandler.displayText(`To cultivate one Field you need ${this.foodManager.needed_citizens_for_land} Citizen and ${this.foodManager.need_seeds_for_land} food 
 
You have `+this.foodManager.cultivated_land+" seeds planed for this Year");let e=new b(["w-100"],"plant-seed-amount"),t=new h("add planned seeding",["btn","btn-primary","w-100"],()=>this.plantSeedsLand(e.element)),a=new h("back",["btn","btn-primary","w-100"],()=>this.manageFoodMenu()),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r]),u=new c([],[s]),g=new c([],[o]);this.handler.selectAreaHandler.setView([d,u,g])}async plantSeedsLand(e){let t=this.foodManager.setCultivatedLand(parseInt(e.value),this.land_free,this.food_amount,this.citizen);t.error?await this.handler.displayHandler.displayText(`I'm sorry commander, but ${t.error_message}`):(this.food_amount-=t.cost,this.land_free-=t.amount,this.infobar.update({food:{amount:this.food_amount,maximum:null}}),this.plantSeedsMenu())}async distributeFoodMenu(){console.table({sum_hunger:this.citizenManager.getCitizenHungerSum(this.citizen)}),await this.handler.displayHandler.displayText("You have "+this.foodManager.distributed_food+" Food planed for this Year");let e=new b(["w-100"],"distribute-food-amount"),t=new h("add food planned for distribute",["btn","btn-primary","w-100"],async()=>this.distributFood(e.element)),a=new h("back",["btn","btn-primary","w-100"],()=>this.manageFoodMenu()),r=new l([],[e]),s=new l([],[t]),o=new l([],[a]),d=new c([],[r]),u=new c([],[s]),g=new c([],[o]);this.handler.selectAreaHandler.setView([d,u,g])}async distributFood(e){let t=this.foodManager.setDistributFood(parseInt(e.value),this.food_amount);t.error?await this.handler.displayHandler.displayText(`I'm sorry commander, but ${t.error_message}`):(this.food_amount-=t.amount,this.infobar.update({food:{amount:this.food_amount,maximum:null}}),this.distributeFoodMenu())}async showReport(){this.handler.selectAreaHandler.clearView(),await this.handler.displayHandler.displayText("This is the Report for Year "+this.year+`
`+this.citizenManager.citizen_dead_this_year+" died last year, and "+this.citizenManager.citizen_new_this_year+` citizens have been born
 you made `+this.foodManager.food_profit_this_year+" Food");let e=new h("Understood",["btn","btn-primary","w-100"],()=>this.mainMenu()),t=new h("Help me",["btn","btn-primary","w-100"],()=>this.mainMenu()),a=new l([],[e]),r=new l([],[t]),s=new c([],[a]),o=new c([],[r]);this.handler.selectAreaHandler.setView([s,o])}async showGameOver(){this.handler.selectAreaHandler.clearView(),await this.handler.displayHandler.displayText("Seems your Colony is lost Commander, it have been "+this.year+" wonderfull years with you as our leader");let e=new h("View Highscore",["btn","btn-primary","w-100"],()=>this.showHighScore()),t=new h("New Game",["btn","btn-primary","w-100"],()=>this.displayChooseFaction()),a=new l([],[e]),r=new l([],[t]),s=new c([],[a]),o=new c([],[r]);this.handler.selectAreaHandler.setView([s,o])}async showHighScore(){this.handler.selectAreaHandler.clearView(),await this.handler.displayHandler.displayText("#")}clearView(){this.handler.selectAreaHandler.setInactive()}setView(e){this.handler.selectAreaHandler.setView(e),this.handler.selectAreaHandler.setActive()}}new K;
